<!DOCTYPE html>
<html lang="nl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>üß™ Comprehensive Sanitization Test Suite</title>
  <style>
    body {
      font-family: 'Courier New', monospace;
      padding: 20px;
      background: #1e1e1e;
      color: #d4d4d4;
      line-height: 1.6;
    }
    h1 {
      color: #4ec9b0;
      border-bottom: 3px solid #4ec9b0;
      padding-bottom: 10px;
      font-size: 28px;
    }
    h2 {
      color: #569cd6;
      margin-top: 30px;
      border-left: 5px solid #569cd6;
      padding-left: 15px;
    }
    .intro {
      background: #2d2d30;
      padding: 20px;
      border-radius: 8px;
      margin: 20px 0;
      border-left: 4px solid #dcdcaa;
    }
    .section-divider {
      margin: 40px 0;
      padding: 20px;
      background: #252526;
      border: 2px solid #569cd6;
      border-radius: 8px;
      text-align: center;
      font-size: 24px;
      font-weight: bold;
      color: #569cd6;
    }
    .test-section {
      margin: 20px 0;
      padding: 15px;
      background: #252526;
      border-left: 3px solid #569cd6;
      border-radius: 4px;
    }
    .test-case {
      margin: 10px 0;
      padding: 10px;
      background: #2d2d30;
      border-radius: 4px;
      font-size: 13px;
    }
    .pass {
      color: #4ec9b0;
      font-weight: bold;
    }
    .fail {
      color: #f48771;
      font-weight: bold;
    }
    .warning {
      color: #dcdcaa;
      font-weight: bold;
    }
    .input {
      color: #ce9178;
    }
    .output {
      color: #9cdcfe;
    }
    .expected {
      color: #4ec9b0;
    }
    .summary {
      margin-top: 30px;
      padding: 20px;
      background: #0e639c;
      border-radius: 8px;
      font-size: 18px;
    }
    .console-log {
      background: #1e1e1e;
      padding: 10px;
      margin: 10px 0;
      border-left: 3px solid #dcdcaa;
      font-size: 11px;
      max-height: 150px;
      overflow-y: auto;
    }
    .ocr-error {
      background: #3e1e1e;
      padding: 3px 6px;
      border-radius: 3px;
      font-weight: bold;
      color: #f48771;
    }
    .correction {
      background: #1e3e1e;
      padding: 3px 6px;
      border-radius: 3px;
      font-weight: bold;
      color: #4ec9b0;
    }
  </style>
</head>
<body>
  <h1>üß™ Comprehensive Sanitization Test Suite</h1>

  <div class="intro">
    <h3>üìã Test Coverage:</h3>
    <p><strong>Part 1: Basic Sanitization Tests</strong> - Tests voor alle 15 velden met normale input edge cases</p>
    <p><strong>Part 2: Field Splitting Tests</strong> - Tests voor gecombineerde velden (IBAN+BIC, postcode+plaats, etc.)</p>
    <p><strong>Part 3: AI/OCR Error Tests</strong> - Tests voor typische AI extractie fouten uit gescande documenten</p>
    <p><strong>Belangrijkste AI/OCR fouten:</strong></p>
    <ul>
      <li><span class="ocr-error">O ‚Üî 0</span> (letter O vs cijfer nul)</li>
      <li><span class="ocr-error">I/l ‚Üî 1</span> (letter I of l vs cijfer √©√©n)</li>
      <li><span class="ocr-error">S ‚Üî 5</span> (letter S vs cijfer vijf)</li>
      <li><span class="ocr-error">B ‚Üî 8</span> (letter B vs cijfer acht)</li>
      <li><span class="ocr-error">Z ‚Üî 2</span> (letter Z vs cijfer twee)</li>
      <li><span class="ocr-error">G ‚Üî 6</span> (letter G vs cijfer zes)</li>
    </ul>
    <p><strong>Verwachting:</strong> <span class="correction">Alle fouten worden automatisch gecorrigeerd</span></p>
  </div>

  <div id="results"></div>
  <div id="summary" class="summary"></div>

  <!-- Load sanitization functions from new sanitization.js framework -->
  <script src="../sanitization.js"></script>

  <script>
    // Capture console output
    const consoleLogs = [];
    const consoleWarnings = [];
    const originalLog = console.log;
    const originalWarn = console.warn;

    console.log = function(...args) {
      consoleLogs.push(args.join(' '));
      originalLog.apply(console, args);
    };

    console.warn = function(...args) {
      consoleWarnings.push(args.join(' '));
      originalWarn.apply(console, args);
    };

    // Test results tracking
    let totalTests = 0;
    let passedTests = 0;
    let failedTests = 0;

    // Note: All sanitization functions are now loaded from popup.js

    // ========================================================================
    // TEST FRAMEWORK
    // ========================================================================

    function runTest(testName, input, sanitizeFunc, expected, expectCorrection = false) {
      totalTests++;
      consoleLogs.length = 0;
      consoleWarnings.length = 0;

      const result = sanitizeFunc(input);
      const passed = JSON.stringify(result) === JSON.stringify(expected);

      if (passed) passedTests++;
      else failedTests++;

      return {
        testName,
        input,
        result,
        expected,
        passed,
        logs: [...consoleLogs],
        warnings: [...consoleWarnings],
        expectCorrection
      };
    }

    function displayResults(sectionName, tests) {
      const section = document.createElement('div');
      section.className = 'test-section';
      section.innerHTML = `<h2>${sectionName}</h2>`;

      tests.forEach(test => {
        const testCase = document.createElement('div');
        testCase.className = 'test-case';

        const status = test.passed ?
          '<span class="pass">‚úÖ PASS</span>' :
          '<span class="fail">‚ùå FAIL</span>';

        let logsHtml = '';
        if (test.logs.length > 0) {
          logsHtml = `<div class="console-log"><strong>‚ú® Corrections:</strong><br>${test.logs.map(l => `‚Üí ${l}`).join('<br>')}</div>`;
        }

        let warningsHtml = '';
        if (test.warnings.length > 0) {
          warningsHtml = `<div class="console-log"><strong>‚ö†Ô∏è Warnings:</strong><br>${test.warnings.map(w => `‚Üí ${w}`).join('<br>')}</div>`;
        }

        testCase.innerHTML = `
          <strong>${test.testName}</strong> ${status}<br>
          <span class="input">Input:</span> ${JSON.stringify(test.input)}<br>
          <span class="output">Output:</span> ${JSON.stringify(test.result)}<br>
          <span class="expected">Expected:</span> ${JSON.stringify(test.expected)}
          ${test.expectCorrection ? '<br><span class="correction">(Should auto-correct OCR error)</span>' : ''}
          ${logsHtml}
          ${warningsHtml}
        `;

        section.appendChild(testCase);
      });

      document.getElementById('results').appendChild(section);
    }

    function displayDivider(text) {
      const divider = document.createElement('div');
      divider.className = 'section-divider';
      divider.textContent = text;
      document.getElementById('results').appendChild(divider);
    }

    // ========================================================================
    // PART 1: BASIC SANITIZATION TESTS
    // ========================================================================

    displayDivider('üìù PART 1: Basic Sanitization Tests (79 tests)');

    // Test 1: BSN
    const bsnTests = [
      runTest('Valid BSN', '123456782', sanitizeBSN, '123456782', false),
      runTest('BSN with spaces', '123 45 67 82', sanitizeBSN, '123456782', false),
      runTest('BSN with dashes', '123-45-67-82', sanitizeBSN, '123456782', false),
      runTest('BSN too short', '12345678', sanitizeBSN, null, false),
      runTest('BSN too long', '1234567890', sanitizeBSN, null, false),
      runTest('BSN with letters', '12a456782', sanitizeBSN, null, false),
      runTest('BSN invalid checksum', '123456789', sanitizeBSN, null, false),
    ];
    displayResults('1. BSN (Burgerservicenummer)', bsnTests);

    // Test 2: IBAN
    const ibanTests = [
      runTest('Valid IBAN', 'NL91ABNA0417164300', sanitizeIBAN, 'NL91ABNA0417164300', false),
      runTest('IBAN with spaces', 'NL91 ABNA 0417 1643 00', sanitizeIBAN, 'NL91ABNA0417164300', false),
      runTest('IBAN lowercase', 'nl91abna0417164300', sanitizeIBAN, 'NL91ABNA0417164300', false),
      runTest('IBAN with dots', 'NL91.ABNA.0417.1643.00', sanitizeIBAN, 'NL91ABNA0417164300', false),
      runTest('IBAN wrong length', 'NL91ABNA041716', sanitizeIBAN, null, false),
      runTest('IBAN invalid checksum', 'NL00ABNA0417164300', sanitizeIBAN, null, false),
    ];
    displayResults('2. IBAN', ibanTests);

    // Test 3: Telefoon
    const phoneTests = [
      runTest('Valid mobile', '0612345678', sanitizePhone, '0612345678', false),
      runTest('Phone with spaces', '06 1234 5678', sanitizePhone, '0612345678', false),
      runTest('Phone with dashes', '06-1234-5678', sanitizePhone, '0612345678', false),
      runTest('Phone with +31', '+31612345678', sanitizePhone, '0612345678', false),
      runTest('Phone with 0031', '0031612345678', sanitizePhone, '0612345678', false),
      runTest('Phone with 31 prefix', '31612345678', sanitizePhone, '0612345678', false),
      runTest('Service number 085', '0851234567', sanitizePhone, '0851234567', false),
      runTest('Phone wrong length', '061234567', sanitizePhone, null, false),
    ];
    displayResults('3. Telefoonnummer', phoneTests);

    // Test 4: Email
    const emailTests = [
      runTest('Valid email', 'test@example.com', sanitizeEmail, 'test@example.com', false),
      runTest('Email with spaces', 'test @ example.com', sanitizeEmail, 'test@example.com', false),
      runTest('Email uppercase', 'TEST@EXAMPLE.COM', sanitizeEmail, 'test@example.com', false),
      runTest('Email trailing dot', 'test@example.com.', sanitizeEmail, 'test@example.com', false),
      runTest('Company email @samangroep', 'test@samangroep.nl', sanitizeEmail, null, false),
      runTest('Company email @saman', 'test@saman.nl', sanitizeEmail, null, false),
      runTest('Invalid email format', 'test@@example', sanitizeEmail, null, false),
    ];
    displayResults('4. Email', emailTests);

    // Test 5: Voorletters
    const initialsTests = [
      runTest('Initials with spaces', 'J H M', sanitizeInitials, 'J.H.M.', false),
      runTest('Initials without dots', 'JHM', sanitizeInitials, 'J.H.M.', false),
      runTest('Initials lowercase', 'j.h.m.', sanitizeInitials, 'J.H.M.', false),
      runTest('Initials with extra spaces', 'J.  H.  M.', sanitizeInitials, 'J.H.M.', false),
      runTest('Single initial', 'J', sanitizeInitials, 'J.', false),
    ];
    displayResults('5. Voorletters (Initials)', initialsTests);

    // Test 6: Achternaam
    const lastNameTests = [
      runTest('Simple last name', 'jansen', sanitizeLastName, 'Jansen', false),
      runTest('Last name with prefix', 'van der Berg', sanitizeLastName, 'Van der Berg', false),
      runTest('Last name ALL CAPS', 'VAN DER BERG', sanitizeLastName, 'Van der Berg', false),
      runTest('Last name extra spaces', 'van  der  Berg', sanitizeLastName, 'Van der Berg', false),
      runTest('Last name with digits', 'Berg2', sanitizeLastName, 'Bergz', true),
      runTest('Very short last name', 'B', sanitizeLastName, 'B', false),
    ];
    displayResults('6. Achternaam (Last Name)', lastNameTests);

    // Test 7: Straatnaam
    const streetTests = [
      runTest('Street lowercase', 'insulindestraat', sanitizeStreet, 'Insulindestraat', false),
      runTest('Street with spaces', 'insulinde  straat', sanitizeStreet, 'Insulinde Straat', false),
      runTest('Street with house number', 'Insulindestraat 59', sanitizeStreet, 'Insulindestraat', false),
      runTest('Street multiple words', 'van gogh straat', sanitizeStreet, 'Van Gogh Straat', false),
    ];
    displayResults('7. Straatnaam (Street)', streetTests);

    // Test 8: Huisnummer
    const houseTests = [
      runTest('House number only', '59', sanitizeHouseNumber, {number: '59', addition: null}, false),
      runTest('House with addition', '59A01', sanitizeHouseNumber, {number: '59', addition: 'A01'}, false),
      runTest('House with spaces', '59 A 01', sanitizeHouseNumber, {number: '59', addition: 'A01'}, false),
      runTest('House lowercase addition', '59a01', sanitizeHouseNumber, {number: '59', addition: 'A01'}, false),
      runTest('House very high number', '10000', sanitizeHouseNumber, {number: '10000', addition: null}, false),
    ];
    displayResults('8. Huisnummer + Toevoeging', houseTests);

    // Test 9: Postcode
    const postalTests = [
      runTest('Valid postal', '1234AB', sanitizePostalCode, '1234 AB', false),
      runTest('Postal with space', '1234 AB', sanitizePostalCode, '1234 AB', false),
      runTest('Postal lowercase', '1234ab', sanitizePostalCode, '1234 AB', false),
      runTest('Postal wrong format', '123AB', sanitizePostalCode, null, false),
    ];
    displayResults('9. Postcode', postalTests);

    // Test 10: Plaatsnaam
    const cityTests = [
      runTest('City lowercase', 'amsterdam', sanitizeCity, 'Amsterdam', false),
      runTest('City ALL CAPS', 'AMSTERDAM', sanitizeCity, 'Amsterdam', false),
      runTest('City with dash', "'s-hertogenbosch", sanitizeCity, "'S-Hertogenbosch", false),
      runTest('City extra spaces', 'Den  Haag', sanitizeCity, 'Den Haag', false),
    ];
    displayResults('10. Plaatsnaam (City)', cityTests);

    // Test 11: Geslacht
    const genderTests = [
      runTest('Gender Man', 'Man', sanitizeGender, 'male', false),
      runTest('Gender Vrouw', 'Vrouw', sanitizeGender, 'female', false),
      runTest('Gender M', 'M', sanitizeGender, 'male', false),
      runTest('Gender V', 'V', sanitizeGender, 'female', false),
      runTest('Gender male', 'male', sanitizeGender, 'male', false),
      runTest('Gender female', 'female', sanitizeGender, 'female', false),
      runTest('Gender unknown', 'X', sanitizeGender, null, false),
    ];
    displayResults('11. Geslacht (Gender)', genderTests);

    // Test 12: Aardgas
    const gasTests = [
      runTest('Gas ja', 'ja', sanitizeGasUsage, 'yes', false),
      runTest('Gas nee', 'nee', sanitizeGasUsage, 'no', false),
      runTest('Gas yes', 'yes', sanitizeGasUsage, 'yes', false),
      runTest('Gas no', 'no', sanitizeGasUsage, 'no', false),
      runTest('Gas 1', '1', sanitizeGasUsage, 'yes', false),
      runTest('Gas 0', '0', sanitizeGasUsage, 'no', false),
      runTest('Gas unknown', 'maybe', sanitizeGasUsage, null, false),
    ];
    displayResults('12. Aardgasgebruik', gasTests);

    // Test 13: Meldcode
    const meldcodeTests = [
      runTest('Valid meldcode', 'KA12345', sanitizeMeldCode, 'KA12345', false),
      runTest('Meldcode lowercase', 'ka12345', sanitizeMeldCode, 'KA12345', false),
      runTest('Meldcode with spaces', 'KA 12345', sanitizeMeldCode, 'KA12345', false),
      runTest('Meldcode wrong format', 'KB12345', sanitizeMeldCode, null, false),
      runTest('Meldcode all zeros', 'KA00000', sanitizeMeldCode, null, false),
    ];
    displayResults('13. Meldcode', meldcodeTests);

    // Test 14: Installatiedatum
    const installDateTests = [
      runTest('Date DD-MM-YYYY', '15-06-2024', sanitizeInstallationDate, '15-06-2024', false),
      runTest('Date DD/MM/YYYY', '15/06/2024', sanitizeInstallationDate, '15-06-2024', false),
      runTest('Date DD.MM.YYYY', '15.06.2024', sanitizeInstallationDate, '15-06-2024', false),
      runTest('Date YYYY-MM-DD', '2024-06-15', sanitizeInstallationDate, '15-06-2024', false),
      runTest('Date short year', '15-06-24', sanitizeInstallationDate, '15-06-2024', false),
      runTest('Date invalid day', '32-06-2024', sanitizeInstallationDate, null, false),
      runTest('Date invalid month', '15-13-2024', sanitizeInstallationDate, null, false),
    ];
    displayResults('14. Installatiedatum', installDateTests);

    // Test 15: Aankoopdatum
    const purchaseDateTests = [
      runTest('Purchase date valid', '01-05-2024', (d) => sanitizePurchaseDate(d, '15-06-2024'), '01-05-2024', false),
      runTest('Purchase YYYY-MM-DD', '2024-05-01', (d) => sanitizePurchaseDate(d, '15-06-2024'), '01-05-2024', false),
      runTest('Purchase short year', '1-5-24', (d) => sanitizePurchaseDate(d, null), '01-05-2024', false),
    ];
    displayResults('15. Aankoopdatum (Purchase Date)', purchaseDateTests);

    // ========================================================================
    // PART 2: FIELD SPLITTING TESTS (Combined Field Scenarios)
    // ========================================================================

    displayDivider('üîÄ PART 2: Field Splitting Tests (21 tests)');

    // Field Split Test 1: IBAN + BIC
    const ibanBicTests = [
      runTest('IBAN: with BIC space separated', 'NL91ABNA0417164300 ABNANL2A', sanitizeIBAN, 'NL91ABNA0417164300', true),
      runTest('IBAN: with BIC label', 'NL91ABNA0417164300 BIC: ABNANL2A', sanitizeIBAN, 'NL91ABNA0417164300', true),
      runTest('IBAN: with BIC attached (8 chars)', 'NL91ABNA0417164300ABNANL2A', sanitizeIBAN, 'NL91ABNA0417164300', true),
      runTest('IBAN: with INGB BIC', 'NL69INGB0123456789 INGBNL2A', sanitizeIBAN, 'NL69INGB0123456789', true),
      runTest('IBAN: with BIC lowercase label', 'NL91ABNA0417164300 bic: ABNANL2A', sanitizeIBAN, 'NL91ABNA0417164300', true),
    ];
    displayResults('Field-1. IBAN + BIC Splitting', ibanBicTests);

    // Field Split Test 2: Postcode + Plaats
    const postalCityTests = [
      runTest('Postal: with city', '1065JD Amsterdam', sanitizePostalCode, '1065 JD', false),
      runTest('Postal: with city space', '1065 JD Amsterdam', sanitizePostalCode, '1065 JD', false),
      runTest('Postal: full address', 'Insulindestraat 59 1065JD Amsterdam', sanitizePostalCode, '1065 JD', false),
      runTest('Postal: address different order', 'Amsterdam 1065JD Insulindestraat 59', sanitizePostalCode, '1065 JD', false),
      runTest('Postal: with hyphenated city', '1234AB \'s-Hertogenbosch', sanitizePostalCode, '1234 AB', false),
    ];
    displayResults('Field-2. Postcode + Plaats Splitting', postalCityTests);

    // Field Split Test 3: Datum met Labels
    const dateLabelTests = [
      runTest('Date: with label "Installatiedatum:"', 'Installatiedatum: 15-06-2024', sanitizeInstallationDate, '15-06-2024', false),
      runTest('Date: with label "Datum"', 'Datum 15-06-2024', sanitizeInstallationDate, '15-06-2024', false),
      runTest('Date: with lowercase label', 'installatiedatum: 15-06-2024', sanitizeInstallationDate, '15-06-2024', false),
      runTest('Date: with extra info', '15-06-2024 Factuur: 12345', sanitizeInstallationDate, '15-06-2024', false),
      runTest('Date: datum installatie label', 'Datum installatie: 15-06-2024', sanitizeInstallationDate, '15-06-2024', false),
    ];
    displayResults('Field-3. Datum Labels Splitting', dateLabelTests);

    // Field Split Test 4: MeldCode met Labels
    const meldcodeLabelTests = [
      runTest('Meldcode: with label', 'Meldcode: KA12345', sanitizeMeldCode, 'KA12345', false),
      runTest('Meldcode: lowercase label', 'meldcode: KA12345', sanitizeMeldCode, 'KA12345', false),
      runTest('Meldcode: with extra info', 'KA12345 Type: Installatie', sanitizeMeldCode, 'KA12345', false),
      runTest('Meldcode: with multiple extra', 'Meldcode: KA12345 Status: Open', sanitizeMeldCode, 'KA12345', false),
      runTest('Meldcode: in sentence', 'Het meldcode is KA12345 voor deze aanvraag', sanitizeMeldCode, 'KA12345', false),
    ];
    displayResults('Field-4. MeldCode Labels Splitting', meldcodeLabelTests);

    // Field Split Test 5: Complex Combined Scenarios
    const complexCombinedTests = [
      runTest('COMPLEX: IBAN with BIC and OCR errors', 'NL9IABNA04I7I64300 ABNANL2A', sanitizeIBAN, 'NL91ABNA0417164300', true),
      runTest('COMPLEX: Postal from address with OCR', 'Insulindestraat 59 1O65JD Amsterdam', sanitizePostalCode, '1065 JD', false),
    ];
    displayResults('Field-5. Complex Combined Scenarios', complexCombinedTests);

    // ========================================================================
    // PART 3: AI/OCR ERROR TESTS
    // ========================================================================

    displayDivider('ü§ñ PART 3: AI/OCR Error Tests (59 tests)');

    // OCR Test 1: BSN with OCR errors
    const bsnOcrTests = [
      runTest('BSN: I‚Üí1 error (I23456782)', 'I23456782', sanitizeBSN, '123456782', true),
      runTest('BSN: O‚Üí0 error (O12345678)', 'O12345678', sanitizeBSN, null, true),  // Invalid checksum after fix
      runTest('BSN: Z‚Üí2 error (12345678Z)', '12345678Z', sanitizeBSN, '123456782', true),
      runTest('BSN: G‚Üí6 error (12305678G)', '12305678G', sanitizeBSN, null, true),  // Invalid checksum after fix
      runTest('BSN: Multiple errors (I2O4S678Z)', 'I2O4S678Z', sanitizeBSN, null, true),  // Invalid checksum after fix
      runTest('BSN: B‚Üí8 error (1234567B2)', '1234567B2', sanitizeBSN, '123456782', true),
      runTest('BSN: S‚Üí5 error (12S456782)', '12S456782', sanitizeBSN, null, true),  // Invalid checksum after fix
    ];
    displayResults('OCR-1. BSN - AI/OCR Fouten', bsnOcrTests);

    // OCR Test 2: IBAN with OCR errors
    const ibanOcrTests = [
      runTest('IBAN: RAB0 ‚Üí RABO', 'NL44RAB00123456789', sanitizeIBAN, 'NL44RABO0123456789', true),
      runTest('IBAN: ING8 ‚Üí INGB', 'NL69ING80123456789', sanitizeIBAN, 'NL69INGB0123456789', true),
      runTest('IBAN: ABN4 ‚Üí ABNA', 'NL91ABN40417164300', sanitizeIBAN, 'NL91ABNA0417164300', true),
      runTest('IBAN: 5NSB ‚Üí SNSB', 'NL805NS80258349876', sanitizeIBAN, 'NL80SNSB0258349876', true),
      runTest('IBAN: SNS8 ‚Üí SNSB', 'NL80SNS80258349876', sanitizeIBAN, 'NL80SNSB0258349876', true),
      runTest('IBAN: TR10 ‚Üí TRIO', 'NL70TR100123456789', sanitizeIBAN, 'NL70TRIO0123456789', true),
      runTest('IBAN: 8UNQ ‚Üí BUNQ', 'NL238UNQ0123456789', sanitizeIBAN, 'NL23BUNQ0123456789', true),
      runTest('IBAN: A8NA ‚Üí ABNA', 'NL91A8NA0417164300', sanitizeIBAN, 'NL91ABNA0417164300', true),
      runTest('IBAN: O in account', 'NL69INGB0I23456789', sanitizeIBAN, 'NL69INGB0123456789', true),
      runTest('IBAN: I‚Üí1 in checksum (NL9I)', 'NL9IABNA0417164300', sanitizeIBAN, 'NL91ABNA0417164300', true),
      runTest('IBAN: Multiple I/O errors in account', 'NL69INGB0I23456789', sanitizeIBAN, 'NL69INGB0123456789', true),
      runTest('IBAN: Multiple errors everywhere', 'NL9IABNA04I7I64300', sanitizeIBAN, 'NL91ABNA0417164300', true),
    ];
    displayResults('OCR-2. IBAN - AI/OCR Fouten (Bank Codes)', ibanOcrTests);

    // OCR Test 3: Telefoon with OCR errors
    const phoneOcrTests = [
      runTest('Phone: O‚Üí0 at start (O612345678)', 'O612345678', sanitizePhone, '0612345678', true),
      runTest('Phone: O‚Üí0 multiple (O2O1234567)', 'O2O1234567', sanitizePhone, '0201234567', true),
      runTest('Phone: I‚Üí1 error (06I2345678)', '06I2345678', sanitizePhone, '0612345678', true),
      runTest('Phone: 0O at start', '0O612345678', sanitizePhone, null, true),  // 11 digits after fix = invalid
      runTest('Phone: Multiple O/I errors (O6I234567O)', 'O6I234567O', sanitizePhone, '0612345670', true),
    ];
    displayResults('OCR-3. Telefoon - AI/OCR Fouten', phoneOcrTests);

    // OCR Test 4: Postcode with OCR errors
    const postalOcrTests = [
      runTest('Postal: I‚Üí1 in digits (I234AB)', 'I234AB', sanitizePostalCode, '1234 AB', true),
      runTest('Postal: O‚Üí0 in digits (1O34AB)', '1O34AB', sanitizePostalCode, '1034 AB', true),
      runTest('Postal: Z‚Üí2 in digits (1Z34AB)', '1Z34AB', sanitizePostalCode, '1234 AB', true),
      runTest('Postal: B‚Üí8 in digits (12B4AB)', '12B4AB', sanitizePostalCode, '1284 AB', true),
      runTest('Postal: S‚Üí5 in digits (S678AB)', 'S678AB', sanitizePostalCode, '5678 AB', true),
      runTest('Postal: 0‚ÜíO in letters (12340B)', '12340B', sanitizePostalCode, '1234 OB', true),
      runTest('Postal: 8‚ÜíB in letters (12348A)', '12348A', sanitizePostalCode, '1234 BA', true),
      runTest('Postal: B‚Üí8 in digits pos 3 (567BAB)', '567BAB', sanitizePostalCode, '5678 AB', true),
      runTest('Postal: Multiple errors (IO3488)', 'IO3488', sanitizePostalCode, '1034 BB', true),
    ];
    displayResults('OCR-4. Postcode - AI/OCR Fouten', postalOcrTests);

    // OCR Test 5: MeldCode with OCR errors
    const meldcodeOcrTests = [
      runTest('Meldcode: K4 ‚Üí KA', 'K412345', sanitizeMeldCode, 'KA12345', true),
      runTest('Meldcode: KO ‚Üí KA', 'KO12345', sanitizeMeldCode, 'KA12345', true),
      runTest('Meldcode: I‚Üí1 in digits (KAI2345)', 'KAI2345', sanitizeMeldCode, 'KA12345', true),
      runTest('Meldcode: O‚Üí0 in digits (KAO1234)', 'KAO1234', sanitizeMeldCode, 'KA01234', true),
      runTest('Meldcode: Z‚Üí2 in digits (KA1Z345)', 'KA1Z345', sanitizeMeldCode, 'KA12345', true),
      runTest('Meldcode: Multiple errors (K4O123S)', 'K4O123S', sanitizeMeldCode, 'KA01235', true),
      runTest('Meldcode: KAO5678 (0‚ÜíO)', 'KAO5678', sanitizeMeldCode, 'KA05678', true),
    ];
    displayResults('OCR-5. MeldCode - AI/OCR Fouten', meldcodeOcrTests);

    // OCR Test 6: Voorletters with OCR errors
    const initialsOcrTests = [
      runTest('Voorletters: 5 ‚Üí S (J.H.5.)', 'J.H.5.', sanitizeInitials, 'J.H.S.', true),
      runTest('Voorletters: 5 ‚Üí S at start (5.A.B.)', '5.A.B.', sanitizeInitials, 'S.A.B.', true),
      runTest('Voorletters: 8 ‚Üí B (S.A.8.)', 'S.A.8.', sanitizeInitials, 'S.A.B.', true),
      runTest('Voorletters: 0 ‚Üí O (P.0.J.)', 'P.0.J.', sanitizeInitials, 'P.O.J.', true),
      runTest('Voorletters: 1 ‚Üí I (1.J.K.)', '1.J.K.', sanitizeInitials, 'I.J.K.', true),
      runTest('Voorletters: 2 ‚Üí Z (T.2.A.)', 'T.2.A.', sanitizeInitials, 'T.Z.A.', true),
      runTest('Voorletters: 6 ‚Üí G (6.H.J.)', '6.H.J.', sanitizeInitials, 'G.H.J.', true),
      runTest('Voorletters: Multiple errors (5.0.8.)', '5.0.8.', sanitizeInitials, 'S.O.B.', true),
      runTest('Voorletters: No dots (JH5)', 'JH5', sanitizeInitials, 'J.H.S.', true),
      runTest('Voorletters: All digits (501)', '501', sanitizeInitials, 'S.O.I.', true),
    ];
    displayResults('OCR-6. Voorletters - AI/OCR Fouten', initialsOcrTests);

    // OCR Test 7: Datum with OCR errors
    const dateOcrTests = [
      runTest('Date: O‚Üí0 at start (O1-06-2024)', 'O1-06-2024', sanitizeInstallationDate, '01-06-2024', true),
      runTest('Date: I‚Üí1 (0I-06-2024)', '0I-06-2024', sanitizeInstallationDate, '01-06-2024', true),
      runTest('Date: Multiple O‚Üí0 (O1-O6-2O24)', 'O1-O6-2O24', sanitizeInstallationDate, '01-06-2024', true),
    ];
    displayResults('OCR-7. Datum - AI/OCR Fouten', dateOcrTests);

    // OCR Test 8: EXTREME Edge Cases
    const extremeTests = [
      runTest('EXTREME: IBAN met ALLES fout', 'NL9IABNA04I7I6430O', sanitizeIBAN, 'NL91ABNA0417164300', true),
      runTest('EXTREME: Postcode chaos', 'IO348B', sanitizePostalCode, '1034 BB', true),
      runTest('EXTREME: Telefoon O6', 'O6-IZ34-567O', sanitizePhone, '0612345670', true),
      runTest('EXTREME: Voorletters alleen cijfers', '5.0.8.1.2.', sanitizeInitials, 'S.O.B.I.Z.', true),
      runTest('EXTREME: Datum volledig O/I chaos', 'OI-O6-2O24', sanitizeInstallationDate, '01-06-2024', true),
    ];
    displayResults('OCR-8. üî• EXTREME Edge Cases (Real Horror Scenarios)', extremeTests);

    // ========================================================================
    // SUMMARY
    // ========================================================================

    const passPercentage = ((passedTests / totalTests) * 100).toFixed(1);
    const summaryDiv = document.getElementById('summary');
    summaryDiv.innerHTML = `
      <h2>üìä Comprehensive Test Summary</h2>
      <p><strong>Total Tests:</strong> ${totalTests} (82 basic + 26 field splitting + 69 OCR)</p>
      <p><strong class="pass">Passed:</strong> ${passedTests}</p>
      <p><strong class="fail">Failed:</strong> ${failedTests}</p>
      <p><strong>Success Rate:</strong> ${passPercentage}%</p>
      ${failedTests === 0 ?
        '<p style="font-size: 24px; color: #4ec9b0;">üéâ Perfect! All tests passed including field splitting & OCR error handling!</p>' :
        '<p style="font-size: 24px; color: #f48771;">‚ö†Ô∏è Some tests failed - review above</p>'}
      <p style="margin-top: 20px;"><strong>Coverage:</strong></p>
      <ul style="margin-top: 10px;">
        <li>Part 1: Basic sanitization (82 tests)</li>
        <li>Part 2: Field splitting - gecombineerde velden (26 tests)</li>
        <li>Part 3: AI/OCR error correcties (69 tests)</li>
      </ul>
      <p><strong>Impact:</strong> Als alle tests slagen, kan het systeem ${totalTests} verschillende scenarios correct afhandelen!</p>
    `;

    console.log(`\n${'='.repeat(70)}`);
    console.log(`COMPREHENSIVE TEST SUMMARY: ${passedTests}/${totalTests} passed (${passPercentage}%)`);
    console.log(`${'='.repeat(70)}\n`);
  </script>
</body>
</html>
